var gameStats={playerBankAmmount:0,betAmmount:50,currentBet:0,discards:1,playerHand:[],playerScore:0,dealerHand:[],dealerScore:0,playersTurn:!0,playerBust:!1,cardsAreDealt:!1,playerWins:!1,dealerWins:!1},App={cards:[{cardName:"ace",cardValue:11,img:"../img/acespades.jpeg",suit:"spades"},{cardName:"two",cardValue:2,img:"../img/twospades.jpeg",suit:"spades"},{cardName:"three",cardValue:3,img:"../img/threespades.jpeg",suit:"spades"},{cardName:"four",cardValue:4,img:"../img/fourspades.jpeg",suit:"spades"},{cardName:"five",cardValue:5,img:"../img/fivespades.jpeg",suit:"spades"},{cardName:"six",cardValue:6,img:"../img/sixspades.jpeg",suit:"spades"},{cardName:"seven",cardValue:7,img:"../img/sevenspades.jpeg",suit:"spades"},{cardName:"eight",cardValue:8,img:"../img/eightspades.jpeg",suit:"spades"},{cardName:"nine",cardValue:9,img:"../img/ninespades.jpeg",suit:"spades"},{cardName:"ten",cardValue:10,img:"../img/tenspades.jpeg",suit:"spades"},{cardName:"jack",cardValue:10,img:"../img/jackspades.jpeg",suit:"spades"},{cardName:"queen",cardValue:10,img:"../img/queenspades.jpeg",suit:"spades"},{cardName:"king",cardValue:10,img:"../img/kingspades.jpeg",suit:"spades"},{cardName:"ace",cardValue:11,img:"../img/aceclubs.jpeg",suit:"clubs"},{cardName:"two",cardValue:2,img:"../img/twoclubs.jpeg",suit:"clubs"},{cardName:"three",cardValue:3,img:"../img/threeclubs.jpeg",suit:"clubs"},{cardName:"four",cardValue:4,img:"../img/fourclubs.jpeg",suit:"clubs"},{cardName:"five",cardValue:5,img:"../img/fiveclubs.jpeg",suit:"clubs"},{cardName:"six",cardValue:6,img:"../img/sixclubs.jpeg",suit:"clubs"},{cardName:"seven",cardValue:7,img:"../img/sevenclubs.jpeg",suit:"clubs"},{cardName:"eight",cardValue:8,img:"../img/eightclubs.jpeg",suit:"clubs"},{cardName:"nine",cardValue:9,img:"../img/nineclubs.jpeg",suit:"clubs"},{cardName:"ten",cardValue:10,img:"../img/tenclubs.jpeg",suit:"clubs"},{cardName:"jack",cardValue:10,img:"../img/jackclubs.jpeg",suit:"clubs"},{cardName:"queen",cardValue:10,img:"../img/queenclubs.jpeg",suit:"clubs"},{cardName:"king",cardValue:10,img:"../img/kingclubs.jpeg",suit:"clubs"},{cardName:"ace",cardValue:11,img:"../img/acehearts.jpeg",suit:"hearts"},{cardName:"two",cardValue:2,img:"../img/twohearts.jpeg",suit:"hearts"},{cardName:"three",cardValue:3,img:"../img/threehearts.jpeg",suit:"hearts"},{cardName:"four",cardValue:4,img:"../img/fourhearts.jpeg",suit:"hearts"},{cardName:"five",cardValue:5,img:"../img/fivehearts.jpeg",suit:"hearts"},{cardName:"six",cardValue:6,img:"../img/sixhearts.jpeg",suit:"hearts"},{cardName:"seven",cardValue:7,img:"../img/sevenhearts.jpeg",suit:"hearts"},{cardName:"eight",cardValue:8,img:"../img/eighthearts.jpeg",suit:"hearts"},{cardName:"nine",cardValue:9,img:"../img/ninehearts.jpeg",suit:"hearts"},{cardName:"ten",cardValue:10,img:"../img/tenhearts.jpeg",suit:"hearts"},{cardName:"jack",cardValue:10,img:"../img/jackhearts.jpeg",suit:"hearts"},{cardName:"queen",cardValue:10,img:"../img/queenhearts.jpeg",suit:"hearts"},{cardName:"king",cardValue:10,img:"../img/kinghearts.jpeg",suit:"hearts"},{cardName:"ace",cardValue:11,img:"../img/acediamonds.jpeg",suit:"diamonds"},{cardName:"two",cardValue:2,img:"../img/twodiamonds.jpeg",suit:"diamonds"},{cardName:"three",cardValue:3,img:"../img/threediamonds.jpeg",suit:"diamonds"},{cardName:"four",cardValue:4,img:"../img/fourdiamonds.jpeg",suit:"diamonds"},{cardName:"five",cardValue:5,img:"../img/fivediamonds.jpeg",suit:"diamonds"},{cardName:"six",cardValue:6,img:"../img/sixdiamonds.jpeg",suit:"diamonds"},{cardName:"seven",cardValue:7,img:"../img/sevendiamonds.jpeg",suit:"diamonds"},{cardName:"eight",cardValue:8,img:"../img/eightdiamonds.jpeg",suit:"diamonds"},{cardName:"nine",cardValue:9,img:"../img/ninediamonds.jpeg",suit:"diamonds"},{cardName:"ten",cardValue:10,img:"../img/tendiamonds.jpeg",suit:"diamonds"},{cardName:"jack",cardValue:10,img:"../img/jackdiamonds.jpeg",suit:"diamonds"},{cardName:"queen",cardValue:10,img:"../img/queendiamonds.jpeg",suit:"diamonds"},{cardName:"king",cardValue:10,img:"../img/kingdiamonds.jpeg",suit:"diamonds"}],newGame:function(){gameStats.playersTurn=!0,gameStats.cardsAreDealt=!1,gameStats.playerHand=[],gameStats.playerScore=0,gameStats.dealerHand=[],gameStats.dealerScore=0,gameStats.currentBet=0,gameStats.playerBankAmmount=2e3,gameStats.cards=this.shuffleCards()},shuffleCards:function(){for(var a,e,t=this.cards,s=t.length;0!==s;)e=Math.floor(Math.random()*s),s-=1,a=t[s],t[s]=t[e],t[e]=a;return t},dealCard:function(){var a=this.cards.pop();this.cards.unshift(a),gameStats.discards++,52===gameStats.discards&&(this.cards=this.shuffleCards(),gameStats.discards=1),gameStats.playersTurn?(gameStats.playerHand.push(a),UI.createPlayerCard(a)):(gameStats.dealerHand.push(a),UI.createDealerCard(a))},discardHand:function(){gameStats.playerHand=[],gameStats.dealerHand=[],UI.clearTable()},playerBet:function(){gameStats.currentBet+=gameStats.betAmmount,gameStats.playerBankAmmount-=gameStats.betAmmount,gameStats.playerBankAmmount<0&&(gameStats.playerBankAmmount+=gameStats.betAmmount,gameStats.currentBet-=gameStats.betAmmount)},doubleBet:function(){gameStats.playerBankAmmount+=gameStats.currentBet,gameStats.currentBet*=2,gameStats.playerBankAmmount-=gameStats.currentBet,gameStats.playerBankAmmount<0&&(gameStats.playerBankAmmount+=gameStats.currentBet,gameStats.currentBet/=2,gameStats.playerBankAmmount-=gameStats.currentBet)},playerWinnings:function(){gameStats.playerBankAmmount+=2*gameStats.currentBet},dealerTurn:function(){var a=this.checkForBlackJack(gameStats.dealerHand);for(a&&(gameStats.cardsAreDealt=!1,gameStats.playersTurn=!0,UI.loseDisplay(),gameStats.currentBet=0,g);gameStats.cardsAreDealt;)gameStats.dealerScore>21?(gameStats.cardsAreDealt=!1,this.playerWinnings(),UI.winDisplay(),gameStats.playersTurn=!0):gameStats.dealerScore>17&&gameStats.dealerScore<gameStats.playerScore?(gameStats.cardsAreDealt=!1,this.playerWinnings(),UI.playerBankDisplay(),UI.winDisplay(),gameStats.playersTurn=!0):gameStats.dealerScore===gameStats.playerScore&&gameStats.dealerScore>11?(gameStats.cardsAreDealt=!1,UI.tieDisplay(),gameStats.playerBankAmmount+=gameStats.currentBet,gameStats.playersTurn=!0):gameStats.dealerScore>gameStats.playerScore?(gameStats.cardsAreDealt=!1,UI.loseDisplay(),gameStats.playersTurn=!0):(App.dealCard(),App.computeHand(gameStats.dealerHand));UI.playerBankDisplay(),gameStats.currentBet=0,App.outOfMoneyGameOver()},computeHand:function(a){for(var e=0,t=0;t<a.length;t++)e+=a[t].cardValue;for(var s=0;s<a.length;s++)e>21&&"ace"===a[s].cardName&&(e-=10);gameStats.playersTurn?gameStats.playerScore=e:gameStats.dealerScore=e},checkForBlackJack:function(a){var e=!1;return"ace"===a[0].cardName?("jack"===a[1].cardName||"queen"===a[1].cardName||"king"===a[1].cardName)&&(e=!0):("jack"===a[0].cardName||"queen"===a[0].cardName||"king"===a[0].cardName)&&"ace"===a[1].cardName&&(e=!0),e},outOfMoneyGameOver:function(){0===gameStats.playerBankAmmount&&(gameStats.playersTurn=!1,gameStats.cardsAreDealt=!0,alert("GAME OVER! PRESS START FOR A NEW GAME!"))}},UI={createPlayerCard:function(a){var e=$("<div>").addClass("card"),t=a.img;e.html('<img class="card" src="'+t+'">'),$("#player-hand").append(e)},createDealerCard:function(a){var e,t=document.getElementById("dealer-hand").children;e=0===t.length?"../img/cardback.jpg":a.img;var s=$("<div>").addClass("card");s.html('<img class="card" src="'+e+'">'),$("#dealer-hand").append(s)},showDealerCard:function(){var a=document.getElementById("dealer-hand").children,e=gameStats.dealerHand[0].img;a[0].innerHTML='<img class="card begin-flip-card" src="../img/cardback.jpg">';setTimeout(function(){a[0].innerHTML='<img class="card end-flip-card" src="'+e+'">'},400)},clearTable:function(){$("#dealer-hand").html(""),$("#player-hand").html(""),$("#game-feedback").html("<span>PLACE YOUR BET, THEN PRESS DEAL</span>"),this.postBet()},postBet:function(){$("#game-display").html("<span> YOUR CURRENT BET: "+gameStats.currentBet+"</span>")},playerBankDisplay:function(){$("#bank-display").html("<span>$"+gameStats.playerBankAmmount+"</span>")},winDisplay:function(){$("#game-display").html("<span> YOU WON $"+2*gameStats.currentBet+"!</span>")},loseDisplay:function(){$("#game-display").html("<span> YOU LOST... SORRY :(</span>")},tieDisplay:function(){$("#game-display").html("<span> YOU TIED, HERES YOUR MONEY BACK!</span>")},displayGameStatus:function(a){var e=$("#game-feedback");gameStats.playersTurn?a>21?e.html("<span>"+a+"! BUST!</span>"):21===a?e.html("<span>YOUR SCORE IS: "+a+"YOU SHOULD STAY</span>"):e.html("<span>YOUR SCORE IS: "+a+", HIT OR STAY</span>"):21>=a?e.html("<span>DEALER SCORE IS: "+a+"</span>"):e.html("<span>"+a+"! BUST!</span>")}},Events={startGame:function(){UI.clearTable(),$("#game-display").html("<span>WELCOME TO BLACK JACK</span>"),App.newGame(),UI.playerBankDisplay()},deal:function(){if(!gameStats.cardsAreDealt){App.discardHand();var a="deal-card-player",e=0,t=setInterval(function(){3===e&&clearInterval(t),$("#deal-card").addClass(a),console.log(a);var s=setTimeout(function(){App.dealCard(),$("#deal-card").removeClass(a),gameStats.playersTurn?(a="deal-card-dealer",gameStats.playersTurn=!1):(a="deal-card-player",gameStats.playersTurn=!0),App.computeHand(gameStats.playerHand),UI.displayGameStatus(gameStats.playerScore),clearTimeout(s)},410);e++},800),s=setTimeout(function(){var a=App.checkForBlackJack(gameStats.playerHand);a&&(gameStats.cardsAreDealt=!1,gameStats.playersTurn=!0,this.playerWinnings(),UI.playerBankDisplay(),UI.winDisplay(),gameStats.currentBet=0),clearTimeout(s)},2600);gameStats.cardsAreDealt=!0}},bet:function(){gameStats.cardsAreDealt||gameStats.playersTurn&&(App.playerBet(),UI.postBet(),UI.playerBankDisplay())},doubleDown:function(){gameStats.playersTurn&&gameStats.cardsAreDealt&&(App.doubleBet(),UI.postBet(),UI.playerBankDisplay(),Events.stay())},hit:function(){if(gameStats.playersTurn&&gameStats.cardsAreDealt)if(gameStats.playerHand.length<5){$("#deal-card").addClass("deal-card-player");var a=setTimeout(function(){App.dealCard(),App.computeHand(gameStats.playerHand),UI.displayGameStatus(gameStats.playerScore),gameStats.playerScore>21&&(UI.loseDisplay(),gameStats.cardsAreDealt=!1,gameStats.playersTurn=!0,gameStats.currentBet=0,App.outOfMoneyGameOver()),$("#deal-card").removeClass("deal-card-player"),clearTimeout(a)},400)}else gameStats.playersTurn=!1,gameStats.dealerHand[0].faceUp=!0,UI.createDealerCard(gameStats.dealerHand),App.dealerTurn()},stay:function(){if(gameStats.playersTurn&&gameStats.cardsAreDealt){gameStats.playersTurn=!1,UI.showDealerCard();setTimeout(function(){App.computeHand(gameStats.dealerHand),App.dealerTurn()},1200)}}};$(function(){$("#start-button").on("click",Events.startGame),$("#deal").on("click",Events.deal),$("#hit").on("click",Events.hit),$("#stay").on("click",Events.stay),$("#bet").on("click",Events.bet),$("#dd").on("click",Events.doubleDown)});
